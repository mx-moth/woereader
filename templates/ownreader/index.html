{% extends "base.html" %}
{% block scripts %}
	<script src="{{ STATIC_URL }}js/jquery.mobile-1.3.2.custom.min.js"></script>
	<script src="{{ STATIC_URL }}js/jquery.django-ajax.js"></script>
	<script src="{{ STATIC_URL }}js/jquery.infinite-scroll.js"></script>
	<script src="{{ STATIC_URL }}js/feed.js"></script>
{% endblock scripts %}

{% block appmenu %}
	<li class="menu">
		<a class="symbol" href="{% url 'ownreader:addFeed' %}">&#8862;</a>
	</li>
	<li class="menu">
		<a class="symbol" href="{% url 'ownreader:UserUpdate' %}">&#128260;</a>
	</li>
	<li class="menu">
		<a class="symbol" href="{% url 'ownreader:toggleSidebar' %}"
		    id="sidebarToggle" onclick="sidebarToggle(); return false;">
		    &#128193;
		</a>
	</li>
	<li class="menu">
		<form action="{% url 'ownreader:markRead' %}" method="post"
		    id="allItemsForm">
            {% csrf_token %}
		    {{ formset }}
		    <button class="symbol" onclick="markAllAsRead(); return false;">
		        &#59146;
		    </button>
		</form>
{% endblock %}

{% block usermenu %}
    {% if prefs.showRead %}
	    <li><a href="{% url 'ownreader:toggleShowRead' %}">Hide Read</a></li>
	{% else %}
	    <li><a href="{% url 'ownreader:toggleShowRead' %}">View Read</a></li>
	{% endif %}
{% endblock %}

{% block wrapperclasses %}
    class="
    {% if prefs.showSidebar %}sidebar{% endif %}
    {% if prefs.viewMode == "CO" %}collapse{% endif %}
    "
{% endblock %}

{% block content %}
<div id="asidewrapper">
	<aside>
		<p>
			-----sidebar-----
		</p>
	</aside>
</div>
<div id="itemwrapper">
{% if items.has_previous %}
    <form action="/" method="post" id="previous_page" class="non-js">
        {% csrf_token %}
        <input name="page" type="hidden"
            value="{{ items.previous_page_number }}" />
        <input class="widebutton" type="submit" value="Newer Entries">
    </form>
{% endif %}
{% for item in items %}
    <div class="item
        {% if item.read %}read{% endif %}
        {% if prefs.viewMode != "EX" %}collapsed{% endif %}"
        id="{{ item.pk }}">
        <div class="item_header">
            <div class="item_title">
                <h3>
                    <a href="{{ item.item.url }}">{{ item.item.title }}</a>
                </h3>
            </div>
            <div class="item_actions">
                <button onclick="toggleShow({{ item.pk }})" class="hider">
                    {% if prefs.viewMode == "EX" %}-
                    {% else %}+
                    {% endif %}
                </button>
                <form action={% url 'ownreader:toggleRead' %} method="post">
                    {% csrf_token %}
                    <input name="id" type="hidden" value="{{ item.pk }}" />
                    <input type="submit" value="Read"
                        onclick="toggleRead({{ item.pk }}); return false;">
                </form>
            </div>
        </div>
        <div class="item_summary">
            {{item.item.content|safe}}
        </div>
    </div>
{% endfor %}
{% if items.has_next %}
    <form action="/" method="post" id="next_page" class="non-js">
        {% csrf_token %}
        <input name="items" id="itemsPerPage" type="hidden"
            value="{{ prefs.itemsPerPage }}" />
        <input name="showRead" id="showRead" type="hidden"
            value="{{ prefs.showRead }}" />
        <input name="page" id="newPage" type="hidden"
            value="{{ items.next_page_number }}" />
        <input class="widebutton" type="submit" value="Older Entries">
    </form>
{% endif %}
</div>
{% endblock %}

